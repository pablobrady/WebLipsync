<!DOCTYPE html>
<html>
<head>
<title>Anim Practice</title>

<style>
.surface {
  background: rgba(0, 0, 0, 0.2) url("images/blur_riverbg.jpg") top left no-repeat;
  width: 1000px;
  height: 750px;
  position: relative;
}
.aliHead {
  position: absolute;
  width: 200px;
  height: 175px;
  // background-color: #f00;
  top: 25px;
  left: 25px;
  color: #fff;
  overflow: hidden;
}
.copyright {
  position: absolute;
  bottom: 0;
  padding: 0 0 5px 5px;
  color: #888;
}
</style>

</head>
<body>
  <canvas id="cartoonCanvas"></canvas>

  <div class="surface">
    <div class="aliBody" id="aliBody-01"><img src="images/ali_body.png" /></div>
    <div class="aliHead" id="aliHead-01"><img src="images/ali_front_faces.png" /></div>
    <div class="copyright">Images © 2005-2016 Cartoon Solutions</div>
  </div>
  <audio id='audioPlayerId' preload="none" controls>
    <source id="mp3Source" type="audio/mpeg" src="audio/ali_intro.mp3">
    <!-- source id="oggSource" src="http://www.oceansoundscapes.com/audio/ocean/OceanBeach-LandsEndwFogHorn.ogg" type="audio/ogg" -->
    Your browser does not support the audio element.  Please update your browser.
  </audio>


<script src="js/sprite.js"></script>
<script src="js/spriteManager.js"></script>
<script src="js/lipsyncManager.js"></script>
<script>

window.headSprite = null;
window.spriteSheet = null;


//// RequestAnimationFrame for Smart Animating ////
(function() {
  // http://paulirish.com/2011/requestanimationframe-for-smart-animating/
  // http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
  // requestAnimationFrame polyfill by Erik Möller. fixes from Paul Irish and Tino Zijdel
  // MIT license

    var lastTime = 0;
    var vendors = ['ms', 'moz', 'webkit', 'o'];
    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
        window.cancelAnimationFrame = window[vendors[x]+'CancelAnimationFrame'] 
                                   || window[vendors[x]+'CancelRequestAnimationFrame'];
    }
 
    if (!window.requestAnimationFrame)
        window.requestAnimationFrame = function(callback, element) {
            var currTime = new Date().getTime();
            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, 
              timeToCall);
            lastTime = currTime + timeToCall;
            return id;
        };
 
    if (!window.cancelAnimationFrame)
        window.cancelAnimationFrame = function(id) {
            clearTimeout(id);
        };
}());


//////////////


var aliBody = document.querySelector("#aliBody-01");
aliBody.style["transform"] = "translateX(300px) translateY(80px)";

var aliHead = document.querySelector("#aliHead-01");
aliHead.style["transform"] = "translateX(360px) translateY(75px)";


var onReadyBeginPlayback = function() {
  console.log( "Custom onReadyBeginPlayback!!!!" );
  this.play("#headIdStr");
};



var lipsMgr = new LipSyncManager( {
  canvasId: 'cartoonCanvas',
  spriteSheetFilename: 'images/ali_front_faces.png',
  fps: 12,
  phonemes: 6,
  headWidth: 200,
  headHeight: 175,
  spriteSheetWidth: 1400,
  spriteSheetHeight: 700,
  expressions: 2,
  audioPlayerId: 'audioPlayerId',
  soundFile: 'audio/ali_intro.mp3',
  lipsyncData:  [ [0,0], [1,0], [2,0], [3,0], [4,0], [5,0], [6,0], [0,0], [1,0], [2,0], [3,0], [4,0], [5,0], [6,0] ],
  headId: 'aliHead-01',
  onReady: onReadyBeginPlayback
} );








</script>

</body>
</html>